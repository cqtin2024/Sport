<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quy Tr√¨nh Thi·∫øt L·∫≠p D·ª± √°n M·∫´u (GitHub + Vercel + Google)</title>
    <!-- T·∫£i Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        pre {
            background-color: #1f2937; /* Gray-800 */
            color: #f9fafb; /* White */
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            font-size: 0.875rem; /* text-sm */
            margin-top: 0.5rem;
        }

        /* 1. Container cho ph√©p chi·ªÅu cao ƒë·ªông */
        #slides-window {
            overflow: hidden;
            height: auto; 
            position: relative; 
        }

        /* 2. Wrapper ph·∫£i l√† relative v√† c√≥ chi·ªÅu r·ªông 100% */
        #slides-wrapper {
            position: relative; 
            width: 100%;
            height: 100%;
        }
        
        /* 3. Slide Item: D√πng absolute ƒë·ªÉ tho√°t kh·ªèi flow v√† ch·ªâ c√≥ slide hi·ªán t·∫°i ·∫£nh h∆∞·ªüng ƒë·∫øn chi·ªÅu cao */
        .slide-item {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            /* √Åp d·ª•ng transition cho opacity v√† transform ƒë·ªÉ c√≥ hi·ªáu ·ª©ng m∆∞·ª£t m√† */
            transition: opacity 0.4s ease-in-out, transform 0.4s ease-in-out; 
            box-sizing: border-box; 
            z-index: 10;
        }

        /* 4. Th√™m m·ªôt l·ªõp ƒë·ªÉ ·∫©n slide kh√¥ng ƒë∆∞·ª£c ch·ªçn */
        .slide-hidden {
            transform: translateX(100%);
            opacity: 0;
            pointer-events: none;
            z-index: 1;
        }

        /* 5. ƒê·∫£m b·∫£o slide hi·ªán t·∫°i ·ªü v·ªã tr√≠ 0 */
        .slide-active {
            transform: translateX(0);
            opacity: 1;
            pointer-events: auto;
            position: relative; /* D√πng relative ƒë·ªÉ n√≥ ƒë·∫©y chi·ªÅu cao c·ªßa #slides-window */
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div id="app" class="max-w-4xl mx-auto">
        <header class="text-center mb-8 bg-white p-6 rounded-xl shadow-lg">
            <h1 class="text-3xl font-bold text-gray-800 mb-2">
                H√†nh Tr√¨nh Tri·ªÉn Khai App Hi·ªán ƒê·∫°i
            </h1>
            <p class="text-xl text-indigo-600 font-semibold">
                GitHub ‚ûî Vercel ‚ûî Google (Firebase)
            </p>
            <p class="text-sm text-gray-500 mt-2">
                Ho√†n th√†nh c√°c b∆∞·ªõc d∆∞·ªõi ƒë√¢y. Ti·∫øn tr√¨nh v√† d·ªØ li·ªáu ƒë∆∞·ª£c l∆∞u t·ª± ƒë·ªông tr√™n tr√¨nh duy·ªát n√†y.
            </p>
        </header>

        <div id="project-data-display" class="mb-8 p-4 bg-yellow-100 border-l-4 border-yellow-500 text-sm text-gray-700 rounded-lg hidden">
            <p class="font-bold mb-1 text-yellow-700">D·ªØ li·ªáu D·ª± √°n ƒê√£ Ghi nh·∫≠n:</p>
            <ul id="data-list" class="list-disc list-inside space-y-0.5">
                <!-- Data will be inserted here -->
            </ul>
        </div>

        <!-- Carousel / Slideshow Structure -->
        <div id="carousel-wrapper" class="relative">
            <!-- Slide Window: Gi·ªØ n·ªôi dung, t·ª± ƒëi·ªÅu ch·ªânh chi·ªÅu cao -->
            <div id="slides-window" class="rounded-2xl shadow-2xl bg-white">
                <div id="slides-wrapper">
                    <!-- Steps/Phases will be rendered here as slides -->
                </div>
            </div>

            <!-- Navigation Controls -->
            <div class="flex justify-between mt-4">
                <button id="prev-btn" onclick="navigateSlides(-1)" 
                        class="px-6 py-2 bg-gray-300 text-gray-800 font-semibold rounded-lg shadow-md hover:bg-gray-400 transition duration-150 focus:outline-none focus:ring-2 focus:ring-gray-500 disabled:opacity-50 disabled:cursor-not-allowed">
                    &larr; Phase Tr∆∞·ªõc
                </button>
                <div id="phase-counter" class="text-lg font-bold text-indigo-600 self-center"></div>
                <button id="next-btn" onclick="navigateSlides(1)" 
                        class="px-6 py-2 bg-indigo-600 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700 transition duration-150 focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed">
                    Phase Ti·∫øp &rarr;
                </button>
            </div>
        </div>
        <!-- End Carousel Structure -->

        <footer class="text-center mt-10 text-gray-500 text-xs">
            Phi√™n b·∫£n h∆∞·ªõng d·∫´n: M·∫´u App Next.js/React.
        </footer>
    </div>

    <script>
        // Khai b√°o bi·∫øn to√†n c·ª•c ƒë·ªÉ l∆∞u tr·ªØ d·ªØ li·ªáu d·ª± √°n
        let projectData = {};
        const PROJECT_DATA_KEY = 'project_setup_data';
        const TASK_STATE_KEY = 'project_setup_task_state';
        let currentPhaseIndex = 0; // State m·ªõi: Theo d√µi slide/phase hi·ªán t·∫°i

        // D·ªØ li·ªáu c√°c b∆∞·ªõc h∆∞·ªõng d·∫´n
        const stepsData = [
            {
                id: 'accounts',
                title: 'Phase 1: Chu·∫©n b·ªã T√†i kho·∫£n C∆° b·∫£n',
                color: 'bg-indigo-500',
                tasks: [
                    { id: 't1_github', text: 'T·∫°o t√†i kho·∫£n GitHub (ho·∫∑c ƒëƒÉng nh·∫≠p).', isInputRequired: true, inputId: 'githubUsername', inputPlaceholder: 'Nh·∫≠p T√™n ng∆∞·ªùi d√πng GitHub c·ªßa b·∫°n' },
                    { id: 't2_vercel', text: 'T·∫°o t√†i kho·∫£n Vercel (n√™n ƒëƒÉng k√Ω b·∫±ng GitHub).', isInputRequired: true, inputId: 'vercelUsername', inputPlaceholder: 'Nh·∫≠p T√™n team/ng∆∞·ªùi d√πng Vercel' },
                    { id: 't3_google_acc', text: 'ƒê·∫£m b·∫£o c√≥ t√†i kho·∫£n Google ƒë·ªÉ d√πng Firebase.', isInputRequired: true, inputId: 'googleEmail', inputPlaceholder: 'Nh·∫≠p Email Google/Firebase' }
                ]
            },
            {
                id: 'github_setup',
                title: 'Phase 2: Thi·∫øt l·∫≠p D·ª± √°n v√† GitHub',
                color: 'bg-gray-700',
                tasks: [
                    { id: 't4_local_project', text: 'Kh·ªüi t·∫°o d·ª± √°n Next.js/React (v√≠ d·ª•: npx create-next-app@latest).', isInputRequired: true, inputId: 'projectName', inputPlaceholder: 'Nh·∫≠p T√™n D·ª± √°n (v√≠ d·ª•: sport-manager)' },
                    { id: 't5_git_init', text: 'Kh·ªüi t·∫°o Git trong th∆∞ m·ª•c d·ª± √°n (git init).' },
                    { id: 't6_first_commit', text: 'Th√™m v√† commit code l·∫ßn ƒë·∫ßu (git add . && git commit -m "initial commit").' },
                    { id: 't7_github_repo', text: 'T·∫°o m·ªôt Repository m·ªõi tr√™n GitHub.', isInputRequired: true, inputId: 'githubRepoUrl', inputPlaceholder: 'D√°n URL Repo GitHub (v√≠ d·ª•: https://github.com/user/project)' },
                    { id: 't8_push', text: 'Li√™n k·∫øt v√† ƒë·∫©y code l√™n GitHub (git remote add origin... && git push...).' }
                ]
            },
            {
                id: 'google_firebase',
                title: 'Phase 3: T√≠ch h·ª£p D·ªãch v·ª• Google (Firebase)',
                color: 'bg-yellow-600',
                tasks: [
                    { id: 't9_firebase_project', text: 'T·∫°o m·ªôt d·ª± √°n m·ªõi trong Firebase Console (ƒë·∫∑t t√™n: ' + (projectData.projectName || 'T√™n D·ª± √°n c·ªßa b·∫°n') + ').' },
                    { id: 't10_web_app', text: 'Th√™m m·ªôt "Web app" v√†o d·ª± √°n Firebase v√† sao ch√©p c·∫•u h√¨nh (firebaseConfig).', isInputRequired: true, inputId: 'firebaseApiKey', inputPlaceholder: 'D√°n Firebase API Key (ƒë·ªÉ d√πng trong .env)' },
                    { id: 't11_install_sdk', text: 'C√†i ƒë·∫∑t Firebase SDK v√†o d·ª± √°n local (npm install firebase).' },
                    { id: 't12_init_firebase', text: 'T·∫°o t·ªáp c·∫•u h√¨nh ƒë·ªÉ kh·ªüi t·∫°o Firebase trong code (s·ª≠ d·ª•ng API Key ƒë√£ l∆∞u).', codeSnippet: 
`// file: firebase-init.js (ho·∫∑c .ts)
import { initializeApp } from "firebase/app";
// L·∫•y c√°c bi·∫øn t·ª´ m√¥i tr∆∞·ªùng (Next.js/React)
const firebaseConfig = {
    apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY, // S·ª≠ d·ª•ng Key ƒë√£ l∆∞u
    authDomain: "..."
    // ...
};
export const app = initializeApp(firebaseConfig);
` 
                    },
                    { id: 't13_auth', text: 'Trong Firebase: B·∫≠t ph∆∞∆°ng th·ª©c ƒëƒÉng nh·∫≠p Google (Authentication -> Sign-in method).' },
                    { id: 't14_env_local', text: 'T·∫°o t·ªáp .env.local v√† th√™m c√°c bi·∫øn m√¥i tr∆∞·ªùng Firebase.', codeSnippet: 
`# file: .env.local
NEXT_PUBLIC_FIREBASE_API_KEY="[KEY_D√ÅN_T·∫†I_ƒê√ÇY]"
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN="..."
# KH√îNG BAO G·ªíM T·ªÜP N√ÄY KHI COMMIT L√äN GITHUB!`
                    }
                ]
            },
            {
                id: 'database_schema',
                title: 'Phase 4: C·∫•u tr√∫c Database (Firestore) & Code M·∫´u (App H·ªôi thao)',
                color: 'bg-green-600',
                tasks: [
                    { id: 't15_firestore_db', text: 'T·∫°o c∆° s·ªü d·ªØ li·ªáu Firestore trong Firebase Console (ch·ªçn mode "Production").' },
                    { id: 't16_security_rules', text: 'Thi·∫øt l·∫≠p Security Rules (ch·∫•p nh·∫≠n read/write cho ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p).', codeSnippet: 
`// V√≠ d·ª• v·ªÅ Firestore Rules (C·∫¶N T√ôY CH·ªàNH THEO B·∫¢O M·∫¨T)
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Ch·ªâ cho ph√©p ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p ƒë·ªçc/ghi
    match /{document=**} {
      allow read, write: if request.auth != null;
    }
  }
}`
                    },
                    { 
                        id: 't17_data_model', 
                        text: 'Thi·∫øt l·∫≠p m√¥ h√¨nh d·ªØ li·ªáu c∆° b·∫£n cho App H·ªôi Thao (Collections: Events, Teams, Athletes).',
                        codeSnippet: 
`// M√¥ h√¨nh d·ªØ li·ªáu App H·ªôi Thao:
// 1. Collection: events (S·ª± ki·ªán)
//    - Document: event_id_1
//      - name: "Gi·∫£i b√≥ng ƒë√° m√πa xu√¢n 2026"
//      - date: "2026-03-01"
//      - status: "Active"
//
// 2. Collection: teams (ƒê·ªôi)
//    - Document: team_id_A
//      - name: "ƒê·ªôi K·ªπ thu·∫≠t"
//      - eventId: event_id_1
//
// 3. Collection: athletes (V·∫≠n ƒë·ªông vi√™n)
//    - Document: athlete_id_X
//      - name: "Nguy·ªÖn VƒÉn A"
//      - teamId: team_id_A
//      - score: 0
// `
                    },
                    { id: 't18_fetch_code', text: 'Vi·∫øt m√£ m·∫´u ƒë·ªÉ fetch d·ªØ li·ªáu Events t·ª´ Firestore.', codeSnippet: 
`// V√≠ d·ª• Code JavaScript/React ƒë·ªÉ ƒë·ªçc d·ªØ li·ªáu (c·∫ßn import db t·ª´ firebase-init.js)
import { collection, getDocs } from "firebase/firestore";
import { db } from "./firebase-init"; // Gi·∫£ s·ª≠ ƒë√£ import

async function getEvents() {
  const eventsCol = collection(db, 'events');
  const eventSnapshot = await getDocs(eventsCol);
  const eventList = eventSnapshot.docs.map(doc => ({ 
    id: doc.id, 
    ...doc.data() 
  }));
  console.log(eventList);
  return eventList;
}`
                    }
                ]
            },
            {
                id: 'vercel_deploy',
                title: 'Phase 5: Tri·ªÉn khai T·ª± ƒë·ªông v·ªõi Vercel',
                color: 'bg-black',
                tasks: [
                    { id: 't19_vercel_import', text: 'ƒêƒÉng nh·∫≠p Vercel v√† ch·ªçn "Add New Project", sau ƒë√≥ Import Repository t·ª´ GitHub (' + (projectData.githubRepoUrl || 'URL Repo ƒë√£ l∆∞u') + ').', isInputRequired: true, inputId: 'vercelProjectUrl', inputPlaceholder: 'D√°n URL Project Vercel (v√≠ d·ª•: https://my-app.vercel.app)' },
                    { id: 't20_env_vercel', text: 'Quan tr·ªçng: D√°n t·∫•t c·∫£ c√°c bi·∫øn m√¥i tr∆∞·ªùng (NEXT_PUBLIC_...) v√†o C·∫•u h√¨nh Bi·∫øn m√¥i tr∆∞·ªùng tr√™n Vercel.' },
                    { id: 't21_deploy_first', text: 'Nh·∫•n Deploy v√† ch·ªù ƒë·ª£i l·∫ßn tri·ªÉn khai ƒë·∫ßu ti√™n th√†nh c√¥ng.' },
                    { id: 't22_test_cd', text: 'Ki·ªÉm tra Continuous Deployment: Th·ª±c hi·ªán m·ªôt thay ƒë·ªïi nh·ªè, commit v√† push l√™n GitHub. Xem Vercel t·ª± ƒë·ªông build v√† deploy l·∫°i.' }
                ]
            },
        ];

        // --- Logic l∆∞u tr·ªØ v√† c·∫≠p nh·∫≠t tr·∫°ng th√°i ---

        function loadState() {
            try {
                const data = localStorage.getItem(PROJECT_DATA_KEY);
                projectData = data ? JSON.parse(data) : {};
            } catch (e) {
                console.error("Error loading project data:", e);
                projectData = {};
            }
        }
        
        function saveProjectData() {
            localStorage.setItem(PROJECT_DATA_KEY, JSON.stringify(projectData));
            updateProjectDataDisplay();
        }

        function saveTaskState(taskId, state) {
            let taskStates = JSON.parse(localStorage.getItem(TASK_STATE_KEY) || '{}');
            taskStates[taskId] = state ? 'completed' : 'pending';
            localStorage.setItem(TASK_STATE_KEY, JSON.stringify(taskStates));
        }

        function loadTaskState(taskId) {
            let taskStates = JSON.parse(localStorage.getItem(TASK_STATE_KEY) || '{}');
            return taskStates[taskId] === 'completed';
        }

        function updateProjectDataDisplay() {
            const dataList = document.getElementById('data-list');
            const dataDisplay = document.getElementById('project-data-display');
            dataList.innerHTML = '';
            let hasData = false;

            for (const [key, value] of Object.entries(projectData)) {
                if (value) {
                    const li = document.createElement('li');
                    const displayKey = key.replace(/([A-Z])/g, ' $1').toUpperCase();
                    li.innerHTML = `<span class="font-medium">${displayKey}:</span> <code class="bg-yellow-200 px-1 rounded">${value}</code>`;
                    dataList.appendChild(li);
                    hasData = true;
                }
            }

            if (hasData) {
                dataDisplay.classList.remove('hidden');
            } else {
                dataDisplay.classList.add('hidden');
            }
        }
        
        function toggleTask(taskId) {
            const checkbox = document.getElementById(`check-${taskId}`);
            const label = document.querySelector(`label[for="check-${taskId}"]`);
            const isChecked = checkbox.checked;

            saveTaskState(taskId, isChecked);

            if (isChecked) {
                label.classList.add('line-through', 'text-gray-400');
                label.classList.remove('text-gray-700');
            } else {
                label.classList.remove('line-through', 'text-gray-400');
                label.classList.add('text-gray-700');
            }
            
            updateProgressBar();
        }

        function handleInput(inputId, value) {
            projectData[inputId] = value;
            saveProjectData();
            
            // Re-render only the current slide to show the new 'ƒê√£ ghi nh·∫≠n' badge and input style
            // NOTE: Lu√¥n g·ªçi updateSlideContent cho phase hi·ªán t·∫°i ƒë·ªÉ c·∫≠p nh·∫≠t gi√° tr·ªã ƒë√£ l∆∞u
            updateSlideContent(currentPhaseIndex); 
            
            updateSlidePosition();
        }

        function copyCode(taskId, buttonElement) {
            const codeContainer = document.getElementById(`code-snippet-${taskId}`);
            if (!codeContainer) return;

            const tempTextarea = document.createElement('textarea');
            tempTextarea.value = codeContainer.textContent.trim(); 
            document.body.appendChild(tempTextarea);
            tempTextarea.select();

            let success = false;
            try {
                success = document.execCommand('copy');
            } catch (err) {
                console.error('Copy failed:', err);
            }

            document.body.removeChild(tempTextarea);

            // C·∫≠p nh·∫≠t tr·∫°ng th√°i n√∫t
            if (success) {
                const originalText = buttonElement.textContent;
                const originalClasses = Array.from(buttonElement.classList);

                buttonElement.textContent = 'ƒê√£ sao ch√©p!';
                buttonElement.classList.remove('bg-gray-600', 'hover:bg-gray-700');
                buttonElement.classList.add('bg-green-600');
                
                setTimeout(() => {
                    buttonElement.textContent = originalText;
                    buttonElement.className = originalClasses.join(' ');
                }, 2000);
            } else {
                const originalText = buttonElement.textContent;
                buttonElement.textContent = 'L·ªói sao ch√©p!';
                buttonElement.classList.remove('bg-gray-600', 'hover:bg-gray-700');
                buttonElement.classList.add('bg-red-500');

                setTimeout(() => {
                    buttonElement.textContent = originalText;
                    buttonElement.classList.remove('bg-red-500');
                    buttonElement.classList.add('bg-gray-600', 'hover:bg-gray-700');
                }, 2000);
            }
        }


        function updateProgressBar() {
            let completed = 0;
            const total = stepsData.reduce((count, section) => count + section.tasks.length, 0);

            stepsData.forEach(section => {
                section.tasks.forEach(task => {
                    if (loadTaskState(task.id)) {
                        completed++;
                    }
                });
            });

            renderProgressBar(completed, total);
        }

        function renderProgressBar(completed, total) {
            let progressBar = document.getElementById('progress-bar-container');
            const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;

            if (!progressBar) {
                progressBar = document.createElement('div');
                progressBar.id = 'progress-bar-container';
                progressBar.className = 'sticky top-0 z-10 p-4 bg-white shadow-xl rounded-b-2xl mb-8';
                
                const header = document.getElementById('app').querySelector('header');
                header.insertAdjacentElement('afterend', progressBar);
            }

            progressBar.innerHTML = `
                <div class="flex justify-between items-center mb-1">
                    <span class="text-sm font-semibold text-gray-700">Ti·∫øn ƒë·ªô Ho√†n th√†nh</span>
                    <span class="text-sm font-bold text-indigo-600">${completed} / ${total} (${percentage}%)</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2.5">
                    <div class="bg-indigo-600 h-2.5 rounded-full transition-all duration-500 ease-out" style="width: ${percentage}%"></div>
                </div>
            `;
            
            if (percentage === 100) {
                progressBar.innerHTML += `
                    <div class="mt-2 text-center text-green-600 font-bold text-lg animate-pulse">
                        üéâ Ch√∫c m·ª´ng! D·ª± √°n c·ªßa b·∫°n ƒë√£ s·∫µn s√†ng Tri·ªÉn khai! üéâ
                    </div>
                `;
            }
        }
        
        function updateSlidePosition() {
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const phaseCounter = document.getElementById('phase-counter');
            
            const totalPhases = getDynamicStepsData().length;
            
            // 1. C·∫≠p nh·∫≠t tr·∫°ng th√°i hi·ªÉn th·ªã c·ªßa t·ª´ng slide
            getDynamicStepsData().forEach((section, index) => {
                const slideElement = document.getElementById(`slide-${section.id}`);
                if (slideElement) {
                    slideElement.classList.remove('slide-active', 'slide-hidden'); 
                    slideElement.style.transform = ''; // X√≥a transform c≈©

                    if (index === currentPhaseIndex) {
                        slideElement.classList.add('slide-active');
                    } else {
                        slideElement.classList.add('slide-hidden');
                        
                        if (index < currentPhaseIndex) {
                            // Slide ƒë√£ qua: Tr∆∞·ª£t v·ªÅ b√™n tr√°i (-100%)
                            slideElement.style.transform = 'translateX(-100%)';
                        } else {
                            // Slide s·∫Øp t·ªõi: Tr∆∞·ª£t v·ªÅ b√™n ph·∫£i (100%)
                            slideElement.style.transform = 'translateX(100%)';
                        }
                    }
                }
            });

            // 2. C·∫≠p nh·∫≠t tr·∫°ng th√°i n√∫t ƒëi·ªÅu h∆∞·ªõng
            prevBtn.disabled = (currentPhaseIndex === 0);
            nextBtn.disabled = (currentPhaseIndex === totalPhases - 1);
            
            // 3. C·∫≠p nh·∫≠t b·ªô ƒë·∫øm Phase
            phaseCounter.textContent = `Phase ${currentPhaseIndex + 1} / ${totalPhases}`;
        }
        
        function goToPhase(index) {
            const totalPhases = getDynamicStepsData().length;
            if (index >= 0 && index < totalPhases) {
                currentPhaseIndex = index;
                
                // *** FIX L·ªñI HI·ªÜU SU·∫§T T·∫†I ƒê√ÇY ***
                const slideElement = document.getElementById(`slide-${getDynamicStepsData()[index].id}`);
                // Ch·ªâ ƒëi·ªÅn n·ªôi dung n·∫øu n√≥ ch∆∞a ƒë∆∞·ª£c ƒëi·ªÅn (innerHTML r·ªóng)
                if (slideElement && slideElement.innerHTML.trim() === '') {
                     updateSlideContent(currentPhaseIndex); 
                } else {
                    // N·∫øu ƒë√£ c√≥ n·ªôi dung, ch·ªâ c·∫ßn g·ªçi l·∫°i ƒë·ªÉ c·∫≠p nh·∫≠t tr·∫°ng th√°i input/text c√° nh√¢n h√≥a
                    updateSlideContent(currentPhaseIndex, false);
                }
                
                // C·∫≠p nh·∫≠t v·ªã tr√≠
                updateSlidePosition(); 
            }
        }

        function navigateSlides(direction) {
            goToPhase(currentPhaseIndex + direction);
        }

        // Th√™m tham s·ªë `isFullRender` ƒë·ªÉ ki·ªÉm so√°t vi·ªác render l·∫°i to√†n b·ªô n·ªôi dung
        function updateSlideContent(phaseIndex, isFullRender = true) {
            const dynamicData = getDynamicStepsData();
            const section = dynamicData[phaseIndex];
            const slideElement = document.getElementById(`slide-${section.id}`);
            
            if (!slideElement) return;

            // N·∫øu kh√¥ng ph·∫£i render l·∫°i to√†n b·ªô, ta tho√°t s·ªõm sau khi c·∫≠p nh·∫≠t c√°c gi√° tr·ªã ƒë·ªông
            if (!isFullRender && slideElement.innerHTML.trim() !== '') {
                // Ch·ªâ c·∫ßn c·∫≠p nh·∫≠t c√°c gi√° tr·ªã ƒë·ªông (v√≠ d·ª•: c√°c bi·∫øn trong Code Snippet/Label)
                // H√†m n√†y s·∫Ω t·ª± g·ªçi l·∫°i render to√†n b·ªô n·∫øu c·∫ßn (v√≠ d·ª•: khi input thay ƒë·ªïi)
                // Tuy nhi√™n, v√¨ ch√∫ng ta ƒë√£ ki·ªÉm so√°t vi·ªác render ·ªü goToPhase, ta kh√¥ng c·∫ßn l√†m g√¨ th√™m
                // ·ªü ƒë√¢y ngo√†i vi·ªác ƒë·∫£m b·∫£o d·ªØ li·ªáu c√° nh√¢n h√≥a (nh∆∞ t√™n d·ª± √°n) l√† ch√≠nh x√°c
                return;
            }
            
            // X√≥a n·ªôi dung c≈© (Ch·ªâ khi isFullRender l√† true)
            slideElement.innerHTML = ''; 

            // ==========================================================
            // 1. T·∫†O THANH BREADCRUMB (PROGRESS HEADER)
            // ==========================================================
            const breadcrumbContainer = document.createElement('div');
            breadcrumbContainer.className = 'flex flex-wrap items-center text-sm font-medium mb-6 p-3 bg-gray-100 rounded-xl shadow-inner border border-gray-200';
            
            dynamicData.forEach((phase, index) => {
                const isCurrent = index === phaseIndex;
                const isCompleted = index < phaseIndex;
                
                if (index > phaseIndex && !isCurrent) {
                    return; 
                }
                
                const span = document.createElement('span');
                span.className = `flex items-center whitespace-nowrap`;

                if (isCompleted) {
                    span.innerHTML = `
                        <button onclick="goToPhase(${index})" class="text-green-700 hover:text-green-900 transition duration-150 flex items-center font-semibold text-xs md:text-sm">
                            <svg class="w-4 h-4 mr-1 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                            ${index + 1}
                        </button>
                    `;
                } else if (isCurrent) {
                    span.innerHTML = `
                        <span class="text-indigo-600 font-extrabold text-sm md:text-base p-1 rounded-md bg-indigo-100">
                            ${index + 1}: ${phase.title}
                        </span>
                    `;
                }
                
                breadcrumbContainer.appendChild(span);

                if (isCompleted) {
                    const separator = document.createElement('span');
                    separator.className = 'mx-1.5 text-gray-400 font-light';
                    separator.textContent = '>';
                    breadcrumbContainer.appendChild(separator);
                }
            });

            slideElement.appendChild(breadcrumbContainer);

            // ==========================================================
            // 2. TI√äU ƒê·ªÄ V√Ä DANH S√ÅCH G·ªåN G√ÄNG H∆†N
            // ==========================================================
            
            const titleElement = document.createElement('h2');
            titleElement.className = `${section.color} text-white text-lg font-bold p-2 rounded-lg mb-4`;
            titleElement.textContent = section.title;
            slideElement.appendChild(titleElement);

            const ul = document.createElement('ul');
            ul.className = 'space-y-0.5 divide-y divide-gray-200'; 

            section.tasks.forEach(task => {
                const isChecked = loadTaskState(task.id);

                const li = document.createElement('li');
                li.className = 'py-1.5 px-3 rounded-lg transition duration-150 hover:bg-gray-50'; 
                
                // Checkbox and Label
                const checkContainer = document.createElement('div');
                checkContainer.className = 'flex items-start';
                
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.id = `check-${task.id}`;
                checkbox.checked = isChecked;
                checkbox.className = 'mt-1 mr-3 w-4 h-4 text-indigo-600 bg-gray-100 border-gray-300 rounded focus:ring-indigo-500 cursor-pointer flex-shrink-0';
                checkbox.addEventListener('change', () => toggleTask(task.id));

                const label = document.createElement('label');
                label.htmlFor = `check-${task.id}`;
                label.className = `flex-1 text-gray-700 font-medium text-sm leading-snug cursor-pointer ${isChecked ? 'line-through text-gray-400' : ''}`;
                // S·ª≠ d·ª•ng innerHTML ƒë·ªÉ parse th·∫ª span b√™n trong task.text
                label.innerHTML = task.text; 

                checkContainer.appendChild(checkbox);
                checkContainer.appendChild(label);
                li.appendChild(checkContainer);

                // Input Field (if required)
                if (task.isInputRequired) {
                    const inputContainer = document.createElement('div');
                    inputContainer.className = 'mt-1 ml-6 flex items-center space-x-3'; 
                    
                    const input = document.createElement('input');
                    input.type = 'text';
                    input.id = `input-${task.inputId}`;
                    
                    const currentValue = projectData[task.inputId] || '';
                    input.value = currentValue;

                    input.placeholder = task.inputPlaceholder;
                    input.className = `flex-grow px-2 py-1.5 border ${currentValue ? 'border-green-400' : 'border-indigo-300'} rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-ring-indigo-500 focus:border-indigo-500 text-xs`;
                    
                    input.addEventListener('blur', (e) => {
                        handleInput(task.inputId, e.target.value);
                    });

                    input.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter') {
                            e.preventDefault(); 
                            e.target.blur(); 
                        }
                    });

                    inputContainer.appendChild(input); 

                    // Status Badge (ƒê√£ ghi nh·∫≠n)
                    if (currentValue) {
                        const statusBadge = document.createElement('span');
                        statusBadge.className = 'flex-shrink-0 inline-flex items-center px-2 py-0.5 text-xs font-medium leading-none text-green-800 bg-green-200 rounded-full';
                        statusBadge.innerHTML = 'ƒê√£ ghi nh·∫≠n';
                        inputContainer.appendChild(statusBadge);
                    }
                    
                    li.appendChild(inputContainer);
                }

                // Code Snippet (if available)
                if (task.codeSnippet) {
                    const codeWrapper = document.createElement('div');
                    codeWrapper.className = 'relative mt-2 ml-6'; 

                    // The actual code block (PRE)
                    const codePre = document.createElement('pre');
                    const code = document.createElement('code');
                    code.id = `code-snippet-${task.id}`; 
                    code.textContent = task.codeSnippet;
                    codePre.appendChild(code);

                    // Copy button
                    const copyButton = document.createElement('button');
                    copyButton.textContent = 'Sao ch√©p Code';
                    copyButton.className = 'absolute top-1 right-1 px-3 py-1 bg-gray-600 text-white text-xs font-semibold rounded-lg hover:bg-gray-700 transition duration-150';
                    copyButton.setAttribute('data-task-id', task.id);
                    copyButton.onclick = (e) => copyCode(task.id, e.target); 
                    
                    codeWrapper.appendChild(codePre);
                    codeWrapper.appendChild(copyButton);
                    li.appendChild(codeWrapper);
                }

                ul.appendChild(li);
            });

            slideElement.appendChild(ul);
        }

        // CH·ªà T·∫†O KHUNG R·ªñNG C·ª¶A C√ÅC SLIDE (KH√îNG ƒêI·ªÄN N·ªòI DUNG)
        function renderSteps() {
            const slidesWrapper = document.getElementById('slides-wrapper');
            slidesWrapper.innerHTML = ''; 

            const dynamicStepsData = getDynamicStepsData();
            
            dynamicStepsData.forEach((section, index) => { 
                const sectionElement = document.createElement('div');
                // T·∫†O KHUNG R·ªñNG
                sectionElement.className = 'slide-item pt-6 px-5 md:px-6'; 
                sectionElement.id = `slide-${section.id}`;
                
                slidesWrapper.appendChild(sectionElement);
                // KH√îNG G·ªåI updateSlideContent(index) ·ªû ƒê√ÇY N·ªÆA
            });
            
            updateProgressBar();
        }

        function getDynamicStepsData() {
            const dynamicData = JSON.parse(JSON.stringify(stepsData)); 
            
            const projectName = projectData.projectName || 'T√™n D·ª± √°n c·ªßa b·∫°n';
            const apiKey = projectData.firebaseApiKey || 'D√°n KEY ƒë√£ l∆∞u t·∫°i ƒë√¢y';
            const repoUrl = projectData.githubRepoUrl || 'URL Repo ƒë√£ l∆∞u';

            dynamicData[2].tasks[0].text = `T·∫°o m·ªôt d·ª± √°n m·ªõi trong Firebase Console (ƒë·∫∑t t√™n: <span class="text-indigo-600 font-semibold">${projectName}</span>).`;
            
            if (dynamicData[2] && dynamicData[2].tasks && dynamicData[2].tasks[5]) { 
                 dynamicData[2].tasks[5].codeSnippet = 
                    `# file: .env.local
NEXT_PUBLIC_FIREBASE_API_KEY="${apiKey}"
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN="..."
# KH√îNG BAO G·ªíM T·ªÜP N√ÄY KHI COMMIT L√äN GITHUB!`;
            }

            dynamicData[4].tasks[0].text = `ƒêƒÉng nh·∫≠p Vercel v√† ch·ªçn "Add New Project", sau ƒë√≥ Import Repository t·ª´ GitHub (<a href="${repoUrl} " target="_blank" class="text-indigo-500 underline">${repoUrl}</a>).`;

            return dynamicData;
        }

        function initApp() {
            loadState(); 
            renderSteps(); 
            
            // G·ªåI updateSlideContent L·∫¶N ƒê·∫¶U TI√äN CHO PHASE 0
            updateSlideContent(currentPhaseIndex);
            
            goToPhase(0); 
            updateProjectDataDisplay(); 
        }

        window.onload = initApp;
    </script>

</body>
</html>
